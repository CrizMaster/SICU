<div class="row my-4">  
    <form [formGroup]="myForm" (ngSubmit)="guardar()" enctype="multipart/form-data">
        <mat-card>
          <mat-card-content>
            <div class="row">
              <div class="col-lg-4 col-md-4 col-xs-12 mt-1">
                  <div class="row">
                  <div class="col-12 m-1">
                      Código de Lotes Catastral
                  </div>
                  <div class="col-12" style="position: relative;">
                      <input type="text" formControlName="codigoLoteCaracterizacion" 
                              class="form-control form-control-sm border">
                  </div>      
                  </div>
              </div>
              <div class="col-lg-4 col-md-4 col-xs-12 mt-1">
                  <div class="row">
                  <div class="col-12 mt-1">
                    &nbsp;
                  </div>
                  <div class="col-12 text-end" style="position: relative;">
                      <mat-slide-toggle
                          class="example-margin"                          
                          formControlName="checked"
                          (change)="Modifica($event)">
                          Modifica
                      </mat-slide-toggle>
                  </div>      
                  </div>
              </div>
              <div class="col-lg-4 col-md-4 col-xs-12 mt-1">
                  <div class="row">
                  <div class="col-12 m-1">
                      Propuesta de Lotes Catastral:
                  </div>
                  <div class="col-12" style="position: relative;">
                      <input type="text" formControlName="codigoLotePropuesta"
                              class="form-control form-control-sm border"
                              [disableControl]="!this.myForm.get('checked').value">
                  </div>      
                  </div>
              </div>
            </div>
            <div class="row mt-3">
                <div class="col-lg-4 col-md-4 col-xs-12 mt-1">
                    <div class="row">
                    <div class="col-12 m-1">
                        Habilitación Urbana
                    </div>
                    <div class="col-12" style="position: relative;">
                      <input type="text" formControlName="habilitacionUrbana" 
                             class="form-control form-control-sm border">
                    </div>      
                    </div>
                </div>
                <div class="col-lg-4 col-md-4 col-xs-12 mt-1">
                    <div class="row">
                      <div class="col-12 mt-1">
                        Tipo División Habilitación
                      </div>
                      <div class="col-12">
                          <input type="text" formControlName="tipoDivisionHabilitacion" 
                                class="form-control form-control-sm border">
                      </div>
                    </div>
                </div>
                <div class="col-lg-4 col-md-4 col-xs-12 mt-1">
                  <div class="row">
                    <div class="col-12 mt-1">
                      Nombre / Número División
                    </div>
                    <div class="col-12">
                        <input type="text" formControlName="numeroDivision" 
                              class="form-control form-control-sm border">
                    </div>
                  </div>
                </div>
            </div>
            <div class="row mt-3">
                <div class="col-lg-4 col-md-4 col-xs-12 mt-1">
                    <div class="row">
                        <div class="col-12 mt-1">
                        Manzana
                        </div>
                        <div class="col-12">
                          <input type="text" formControlName="manzanaUrbana" 
                                  class="form-control form-control-sm border">
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 col-md-4 col-xs-12 mt-1">
                    <div class="row">
                        <div class="col-12 mt-1">
                        Lote
                        </div>
                        <div class="col-12">
                          <input type="text" formControlName="loteUrbano" 
                                  class="form-control form-control-sm border">
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 col-md-4 col-xs-12 mt-1">
                  <div class="row">
                      <div class="col-12 mt-1">
                      Sub Lote
                      </div>
                      <div class="col-12">
                        <input type="text" formControlName="subLote" 
                                class="form-control form-control-sm border">
                      </div>
                  </div>
              </div>                
            </div>          
          </mat-card-content>
        </mat-card>
        <div class="row mt-3">
            <div class="col-lg-12 col-md-12 col-xs-12 mt-1">
              <ng-container>
                <span class="fs-6 fw-bold">Puertas</span>
                <mat-divider class="my-2"></mat-divider>
                <div class="table-responsive">
                  <table class="table table-sm table-hover shadow p-3 mb-5 bg-body-tertiary" style="border: 1px solid #dadada;">                    
                    <thead>
                      <tr style="color: white; background-color: #dadada;">
                        <th scope="col" class="text-center align-middle title-table fw-normal" >Vía</th>
                        <th scope="col" class="text-center align-middle title-table fw-normal" style="width:120px;">Activación</th>
                        <th scope="col" class="text-center align-middle title-table fw-normal" style="width:120px;">Nro Orden</th>
                        <th scope="col" class="text-center align-middle title-table fw-normal" style="width:200px;">Tipo de Puerta</th>
                        <th scope="col" class="text-center align-middle title-table fw-normal" style="width:250px;">Condición númerica</th>
                        <th scope="col" class="text-center align-middle title-table fw-normal" style="width:120px; height: 60px;">Nro Municipal</th>
                      </tr>
                    </thead>
                    <tbody>
                      <ng-container formArrayName="vias" *ngFor="let via of getFormControl.controls; let i = index">
                        <tr [formGroupName]="i">
                          <td class="align-middle px-2">
                            {{getFormControl.controls[i].get('nombreVia').value}}
                          </td>
                          <td class="align-middle text-center px-2">
                            <mat-slide-toggle
                                class="example-margin"
                                [color]="color"
                                formControlName="checkedAct"
                                (change)="Activacion($event, getFormControl.controls[i])">
                            </mat-slide-toggle>                          
                          </td>
                          <td class="align-middle px-2">
                            <input type="text" formControlName="numeroOrden"
                            class="form-control form-control-sm border">                          
                          </td>
                          <td class="align-middle px-2">
                            <select name="idTipoPuerta"
                                    formControlName="idTipoPuerta"
                                    class="form-select form-select-sm border focus-ring"
                                    aria-label="select-idTipoPuerta" [pattern]="pattern1Digs">
                                    <option *ngFor="let tp of listTipoPuerta" [value]="tp.value">{{ tp.text }}</option>
                            </select>                          
                          </td>
                          <td class="align-middle px-2">
                            <select name="idCondicion"
                                    formControlName="idCondicion"
                                    class="form-select form-select-sm border focus-ring"
                                    (change)="CondicionNumerica($event, getFormControl.controls[i])"
                                    aria-label="select-idCondicion" [pattern]="pattern1Digs">
                                    <option *ngFor="let tp of listCondicion" [value]="tp.value">{{ tp.text }}</option>
                            </select>                          
                          </td>
                          <td class="align-middle px-2">
                            <input type="text" formControlName="numeroMunicipal"
                            class="form-control form-control-sm border">                          
                          </td>
                        </tr>
                      </ng-container>                      
                    </tbody>
                  </table>
                </div>                
            </ng-container>
            </div>
        </div>
        <div class="row">
          <div class="col-md-4">&nbsp;</div>
          <div class="col-md-4 border border-2 border-danger p-2 mb-2 border-opacity-25 rounded">
            <input class="btn btn-sm btn-danger bg-cofopri w-100 mt-1 shadow-sm" 
              type="file" (change)="capturarFile($event)" accept="image/*" multiple/>
          </div>
        </div>
        <div class="row py-2">
          <div class="col-md-4">&nbsp;</div>
          <div class="col-md-4">
            <div class="row border border-2 border-danger p-2 mb-2 border-opacity-25 rounded" *ngIf="imagenes.length > 0">
              <div class="col-md-12" *ngFor="let img of imagenes">
                <mat-card class="my-2">
                  <div class="d-flex">
                    <div class="p-2" style="width: 70px;">
                      <img [src]="img.base64" alt="" width="60px">
                    </div>
                    <div class="p-2 flex-grow-1">
                      <div class="row">
                        <div class="col-md-12">{{img.name}}</div>
                        <div class="col-md-6">{{img.tamanio}}</div>
                        <div class="col-md-6 text-end mt-1">
                          <button mat-mini-fab color="warn" style="background: rgb(235, 30, 35);" 
                              title="Quitar" (click)="quitarImagen(img)">
                            <mat-icon>delete</mat-icon>
                          </button>&nbsp;
                          <button mat-mini-fab color="primary" style="background: rgb(21, 56, 255);"
                          title="Ver" (click)="verImagen($event, img)">
                            <mat-icon>search</mat-icon>
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </mat-card>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-md-4">&nbsp;</div>
          <div class="col-md-4 border border-2 border-warning p-2 mb-2 border-opacity-25 rounded">
            <button type="submit" class="btn btn-sm btn-warning w-100 mt-1 shadow-sm" 
              [disabled]="myForm.invalid">
              <i class="bi bi-save"></i>&nbsp; Grabar      
            </button>
          </div>
        </div>
    </form>
</div>